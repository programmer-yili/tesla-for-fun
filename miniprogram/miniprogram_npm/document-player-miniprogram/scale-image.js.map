{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scale-image.ts"],"names":[],"mappings":"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","file":"scale-image.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","Component({\n  externalClasses: ['inner-class'],\n  properties: {\n    src: String,\n    custom_class: String,\n    width: {\n      type: String\n    },\n    height: {\n      type: String,\n      observer(newVal) {\n        this.setData({\n          // eslint-disable-next-line radix\n          initOffset: ((parseInt(newVal) - this.data.touch.baseHeight) / 2)\n        })\n      }\n    }\n  },\n  data: {\n    isLoading: true,\n    touch: {\n      distance: 0,\n      scale: 1,\n      baseWidth: '50%',\n      baseHeight: '50%',\n      scaleWidth: null,\n      scaleHeight: null\n    },\n    initOffset: 0\n  },\n  lifetimes: {\n    attached() {\n      this._resizeToWidth(this.properties.width, this.properties.height)\n    }\n  },\n  methods: {\n    touchstartCallback(e) {\n      // 单手指缩放开始，也不做任何处理\n      if (e.touches.length !== 2) return\n\n      const xMove = e.touches[1].clientX - e.touches[0].clientX\n      const yMove = e.touches[1].clientY - e.touches[0].clientY\n      const distance = Math.sqrt(xMove * xMove + yMove * yMove)\n      this.setData({\n        'touch.distance': distance,\n      })\n    },\n    touchmoveCallback(e) {\n      const windowHeight = wx.getSystemInfoSync().windowHeight\n      const imgY = (windowHeight - this.data.touch.scaleHeight) / 2\n      const touch = this.data.touch\n      // 单手指缩放我们不做任何操作\n      if (e.touches.length !== 2) return\n      const xMove = e.touches[1].clientX - e.touches[0].clientX\n      const yMove = e.touches[1].clientY - e.touches[0].clientY\n      // 新的 ditance\n      const distance = Math.sqrt(xMove * xMove + yMove * yMove)\n      const distanceDiff = distance - touch.distance\n      let newScale = touch.scale + 0.005 * distanceDiff\n      // 为了防止缩放得太大，所以scale需要限制，同理最小值也是\n      if (newScale >= 2) {\n        newScale = 2\n      }\n      if (newScale <= 1) {\n        newScale = 1\n      }\n      const scaleWidth = newScale * touch.baseWidth\n      const scaleHeight = newScale * touch.baseHeight\n      // 赋值 新的 => 旧的\n      this.setData({\n        'touch.distance': distance,\n        'touch.scale': newScale,\n        'touch.scaleWidth': scaleWidth,\n        'touch.scaleHeight': scaleHeight,\n        'touch.diff': distanceDiff,\n        initOffset: imgY\n      })\n    },\n    bindload(e) {\n      if (this.data.src !== './assets/loading.gif') {\n        this.setData({\n          isLoading: false\n        })\n      }\n      const targetWidth = e.detail.width\n      const targetHeight = e.detail.height\n      this._resizeToWidth(targetWidth, targetHeight)\n    },\n    resize() {\n      const targetWidth = this.data.touch.baseWidth\n      const targetHeight = this.data.touch.baseHeight\n      this._resizeToWidth(targetWidth, targetHeight)\n    },\n    _resizeToWidth(targetWidth, targetHeight) {\n      const width = this.properties.width\n      const height = (width * targetHeight) / targetWidth\n      this.setData({\n        'touch.baseWidth': width,\n        'touch.baseHeight': height,\n        'touch.scaleWidth': width,\n        'touch.scaleHeight': height,\n        initOffset: (this.properties.height - height) / 2\n      })\n    },\n    _resizeToHeight(targetWidth, targetHeight) {\n      const height = this.properties.height\n      const width = (height * targetHeight) / targetWidth\n      this.setData({\n        'touch.baseWidth': width,\n        'touch.baseHeight': height,\n        'touch.scaleWidth': width,\n        'touch.scaleHeight': height\n      })\n    }\n  }\n})\n"],"sourceRoot":""}